

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Hypergraph database backends &mdash; Graphbrain 0.5.1-dev documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Notebooks and visualizations" href="notebooks.html" />
    <link rel="prev" title="Knowledge agents" href="agents.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #333" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/graphbrain-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    <div>
    <a href="https://socsemics.huma-num.fr/" style="margin:0px; text-align:center">
        <img style="width: 75%; height: 75%; border-radius: 0px; margin:0px; padding:5px; background:#ffffff" src="/_static/socsemics.png"/>
    </a>
    </div>
    
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials and examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../manual.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="notation.html">Semantic Hypergraph notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="special-relations.html">Special relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="hypergraph-operations.html">Basic hypergraph operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns.html">Patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="discovering-patterns.html">Discovering patterns</a></li>
<li class="toctree-l2"><a class="reference internal" href="parsing.html">Parsing natural language</a></li>
<li class="toctree-l2"><a class="reference internal" href="agents.html">Knowledge agents</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Hypergraph database backends</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sqlite-3">SQLite 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#leveldb">LevelDB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#macos">macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#anaconda-on-macos">Anaconda on macOS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#windows">Windows</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="notebooks.html">Notebooks and visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command-line interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="internals.html">Internals and extending Graphbrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html">API reference</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../team.html">Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../thanks.html">Thanks</a></li>
</ul>

            
          

        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Graphbrain</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          



















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../manual.html">Manual</a> &raquo;</li>
        
      <li>Hypergraph database backends</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <!-- User defined GitHub URL -->
              <a href="https://github.com/graphbrain/graphbrain" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="hypergraph-database-backends">
<h1>Hypergraph database backends<a class="headerlink" href="#hypergraph-database-backends" title="Permalink to this headline">¶</a></h1>
<p>In the future, we expect other hypergraph database backends to be included in the library (for example, fully in-memory hypergraphs for even higher performance at relatively small sizes, or distributed hypergraphs for huge datasets, fault-tolerance, etc.). Graphbrain is an open source project, so contributions from people interested in developing such implementations are very welcome!</p>
<div class="section" id="sqlite-3">
<h2>SQLite 3<a class="headerlink" href="#sqlite-3" title="Permalink to this headline">¶</a></h2>
<p><strong>File extensions:</strong> <code class="docutils literal notranslate"><span class="pre">.db</span></code>, <code class="docutils literal notranslate"><span class="pre">.sqlite</span></code>, <code class="docutils literal notranslate"><span class="pre">.sqlite3</span></code></p>
<p><strong>Pros:</strong> universal support; native to Python; very fast; concurrent access; single file storage</p>
<p><strong>Cons:</strong> not space-efficient; possibly not as fast as LevelDB</p>
<p>This backend comes with vamilla Graphbrain.</p>
</div>
<div class="section" id="leveldb">
<h2>LevelDB<a class="headerlink" href="#leveldb" title="Permalink to this headline">¶</a></h2>
<p><strong>File extensions:</strong> <code class="docutils literal notranslate"><span class="pre">.hg</span></code>, <code class="docutils literal notranslate"><span class="pre">.leveldb</span></code></p>
<p><strong>Pros:</strong> very space-efficient; very fast</p>
<p><strong>Cons:</strong> no concurrent access; hard to install outside of Linux; directory structure not as nice as single file</p>
<p>LevelDB is a local filesytem-based high-performance key-value store. To support LevelDB, you will need to build Graphbrain from source with a special option set, <a class="reference external" href="/installation.html#building-graphbrain-with-support-for-leveldb-hypergraph-databases">as explained in the installation instructions</a>.</p>
<p>The <em>plyvel</em> library is required for LevelDB support. Unfortunately, this library is currently hard to install outsisde of Linux systems. Below is the current best information we have for macOS and Windows.</p>
<div class="section" id="macos">
<h3>macOS<a class="headerlink" href="#macos" title="Permalink to this headline">¶</a></h3>
<p>LevelDB can be installed with brew, but currently the latest version is not compatible with the Python wrapper (plyvel). The solution is to install LevelDB version 1.22. With brew, this can be achieved in the following way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brew tap bagonyi/homebrew-formulae git@github.com:bagonyi/homebrew-formulae.git
$ brew extract --version=1.22 leveldb bagonyi/formulae
$ brew install leveldb@1.22
</pre></div>
</div>
<p>(from <a class="reference external" href="https://github.com/bagonyi/homebrew-formulae">https://github.com/bagonyi/homebrew-formulae</a>)</p>
<p>The first command above might cause an error, but it appears it can be ignored. If a preexisting installation of LevelDB exists, it should be removed first:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ brew uninstall leveldb
</pre></div>
</div>
<p>Another option is to perform your own custom build of LevelDB 1.23, with the following line removed from its <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="p">(</span><span class="n">CMAKE_CXX_FLAGS</span> <span class="s2">&quot;$</span><span class="si">{CMAKE_CXX_FLAGS}</span><span class="s2"> -fno-rtti&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For more details: <a class="reference external" href="https://github.com/wbolster/plyvel/issues/114">https://github.com/wbolster/plyvel/issues/114</a>.</p>
</div>
<div class="section" id="anaconda-on-macos">
<h3>Anaconda on macOS<a class="headerlink" href="#anaconda-on-macos" title="Permalink to this headline">¶</a></h3>
<p>We have found cases where the plyvel library that is installed as a dependency by Graphbrain does not work in Anaconda environments. This was observed on macOS Big Sur, on MacBook Pro laptops with the M1 chip. It is unknown if it might apply in other cases.</p>
<p>You might get error messages such as this one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ImportError</span><span class="p">:</span> <span class="n">dlopen</span><span class="p">(</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">plyvel</span><span class="o">/</span><span class="n">plyvel</span><span class="o">.</span><span class="n">cpython</span><span class="o">-</span><span class="mi">38</span><span class="o">-</span><span class="n">darwin</span><span class="o">.</span><span class="n">so</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">Symbol</span> <span class="ow">not</span> <span class="n">found</span><span class="p">:</span> <span class="n">_ZTIN7leveldb10ComparatorE</span>
<span class="n">Referenced</span> <span class="n">from</span><span class="p">:</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">plyvel</span><span class="o">/</span><span class="n">_plyvel</span><span class="o">.</span><span class="n">cpython</span><span class="o">-</span><span class="mi">38</span><span class="o">-</span><span class="n">darwin</span><span class="o">.</span><span class="n">so</span>
<span class="n">Expected</span> <span class="ow">in</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">leveldb</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libleveldb</span><span class="mf">.1</span><span class="o">.</span><span class="n">dylib</span>
<span class="ow">in</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">plyvel</span><span class="o">/</span><span class="n">_plyvel</span><span class="o">.</span><span class="n">cpython</span><span class="o">-</span><span class="mi">38</span><span class="o">-</span><span class="n">darwin</span><span class="o">.</span><span class="n">so</span>
</pre></div>
</div>
<p>The solution is to replace plyvel with one from the Anaconda repositories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip uninstall plyvel
$ conda install -c conda-forge plyvel
</pre></div>
</div>
</div>
<div class="section" id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">¶</a></h3>
<p>To install <em>plyvel</em>, <em>boost.lib</em> and <em>leveldb.lib</em> must be compiled first.</p>
<ul class="simple">
<li><p><strong>boost.lib (x64)</strong></p></li>
</ul>
<p><strong>step 1</strong> download and unzip the <em>Boost</em> library:  <a class="reference external" href="https://www.boost.org/">https://www.boost.org/</a></p>
<p><strong>step 2</strong> make sure <em>cl</em> is the environment variable</p>
<p><strong>step 3</strong> open <em>x64 Native Tools Command Prompt</em> for <em>VS2017</em>. Get into the directory of the unzipped <em>Boost</em></p>
<p><strong>step 4</strong> run command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ bootstrap.bat
</pre></div>
</div>
<p><em>b2.exe</em> and <em>bjam.exe</em> will be added after this step.</p>
<p><strong>step 5</strong> open and modify <em>project-config.jam</em> in the current directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ import option ;
$ using msvc : 14.1 : “E: \VS2017\VC\Tools\MSVC\14.1-.250117\bin\HostX64\x64\cl.exe” ;
$ option.set keep-going : false ;
</pre></div>
</div>
<p>Please note that you should: i) use your own VS version number (e.g. 14.1) ii) use your own directory of _cl.exe_.</p>
<p><strong>step 6</strong> <em>(note: this step may take 1 - 3 hours)</em> create a folder named build in the current directory, then run command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ b2.exe stage --toolset=msvc-14.1 address-model=64 --stagedir=&quot;E:\mylib\boost\bin1.64.0\VC14.
$ 1&quot; threading=multi --build-type=complete --build-dir=&quot;E:\mylib\boost\boost_1_64_0\build&quot;
</pre></div>
</div>
<p>Please note that you should: i) use your own directory names ii) be careful about the VS version number</p>
<ul class="simple">
<li><p><strong>leveldb.lib</strong></p></li>
</ul>
<p><strong>step 1</strong> download the source code of <em>LevelDB</em> for windows: <a class="reference external" href="https://github.com/vaskomitanov/leveldb">https://github.com/vaskomitanov/leveldb</a></p>
<p><strong>step 2</strong> open <em>Visual Studio</em> (2017). Create a project:</p>
<blockquote>
<div><ul class="simple">
<li><p>file – new – project from existing code</p></li>
<li><p>choose the type of project: <em>Visual C++</em></p></li>
<li><p>project file location: the directory of <em>LevelDB</em></p></li>
<li><p>project name: <em>LevelDB</em></p></li>
<li><p>project type: <em>LIB</em></p></li>
<li><p>preprocessor definition: <em>LEVELDB_PLATFORM_WINDOWS;OS_WIN; WIN32</em></p></li>
<li><p>include search path: <em>E:LIBleveldb-windows;E:LIBleveldb-windowsinclude</em> (the directory of <em>LevelDB</em> and its <em>include</em>)</p></li>
<li><p>click <em>finish</em></p></li>
</ul>
</div></blockquote>
<p><strong>step 3</strong> set <em>LevelDB.lib</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>project – properties – configuration properties – configuration type: <em>LIB</em></p></li>
<li><p>configuration properties – C/C++ - General – preprocessor – preprocessor definition: <em>LEVELDB_PLATFORM_WINDOWS;OS_WIN; WIN32</em></p></li>
<li><p>linker – general – additional library directory: <em>E:LIBboost64stagelib</em> (use your own path)</p></li>
</ul>
</div></blockquote>
<p><strong>step 4</strong> open <em>solution explorer</em>, exclude the following files <em>(tip: you can search and right click on the target files)</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>files ends with <em>_test.cc</em> and <em>_bench.cc</em></p></li>
<li><p><em>port/port_android.cc</em></p></li>
<li><p><em>port/port_posix.cc</em></p></li>
<li><p><em>util/env_posix.cc</em></p></li>
</ul>
</div></blockquote>
<p><strong>step 5</strong> modify code:</p>
<p>in <em>dbc.cc</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ delete #include &lt; unistd.h&gt;
</pre></div>
</div>
<p>in <em>portport.h</em> - add the lines below before first <code class="docutils literal notranslate"><span class="pre">#endif</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ elif defined(LEVELDB_PLATFORM_WINDOWS)
$ include &quot;port/port_win.h&quot;
</pre></div>
</div>
<p><strong>step 6</strong> note: remember to compile as <em>release x64</em></p>
<ul class="simple">
<li><p><strong>plyvel</strong></p></li>
</ul>
<p>modify <em>setup.py</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Extension</span><span class="p">(</span>
                <span class="o">...</span>
                <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;leveldb vaskomitanov-r x64&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;libboost_chrono-vc141-mt-x64-1_69&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;libboost_date_time-vc141-mt-x64-1_69&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;libboost_filesystem-vc141-mt-x64-1_69&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;libboost_system-vc141-mt-x64-1_69&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;libboost_thread-vc141-mt-x64-1_69&#39;</span><span class="p">],</span>
                <span class="o">...</span>
    <span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Cmake</strong></p></li>
</ul>
<p>you may also need to install Cmake, please check the official guidance here: <a class="reference external" href="https://cgold.readthedocs.io/en/latest/first-step/installation.html#windows">https://cgold.readthedocs.io/en/latest/first-step/installation.html#windows</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="notebooks.html" class="btn btn-neutral float-right" title="Notebooks and visualizations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="agents.html" class="btn btn-neutral float-left" title="Knowledge agents" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021 CNRS.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>